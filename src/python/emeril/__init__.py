##
## Copyright (c) 2018 The Regents of The University of Michigan
## 
## This file is part of Emeril
## (see https://www.github.com/umich-dbgroup/emeril/).
## 
## Licensed to the Apache Software Foundation (ASF) under one
## or more contributor license agreements.  See the NOTICE file
## distributed with this work for additional information
## regarding copyright ownership.  The ASF licenses this file
## to you under the Apache License, Version 2.0 (the
## "License"); you may not use this file except in compliance
## with the License.  You may obtain a copy of the License at
## 
##   http://www.apache.org/licenses/LICENSE-2.0
## 
## Unless required by applicable law or agreed to in writing,
## software distributed under the License is distributed on an
## "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
## KIND, either express or implied.  See the License for the
## specific language governing permissions and limitations
## under the License.
## 
## Author: Dolan Antenucci (dol@umich.edu)
##
import subprocess
import math
import itertools
import copy
from timeit import default_timer as timer
import os
import cPickle as pickle
import re
import sys
from time import sleep
import random
from HTMLParser import HTMLParser
import datetime as dt

import numpy as np
import pandas as pd
from scipy import stats, integrate
import sqlite3
from collections import defaultdict
from scipy.stats.stats import pearsonr
from scipy.stats import kendalltau, chisquare, entropy
# import statsmodels.nonparametric.api as smnp
from scipy.spatial.distance import squareform, cosine, braycurtis
from pyemd import emd
import requests

# import matplotlib.pyplot as plt
# matplotlib.use('Agg')
# import plotly
# import plotly.plotly as py
# import seaborn as sns
# sns.set(color_codes=True)


# np.random.seed(sum(map(ord, "distributions")))
RANDOM_SEED = 123458678
np.random.seed(RANDOM_SEED)


## disabling print buffering ##
class Unbuffered(object):
   def __init__(self, stream):
       self.stream = stream
   def write(self, data):
       self.stream.write(data)
       self.stream.flush()
   def __getattr__(self, attr):
       return getattr(self.stream, attr)
sys.stdout = Unbuffered(sys.stdout)


SIGNALS = {
    u'summer': [1.0, 0.94594594594594594, 0.89189189189189189, 0.81081081081081074, 0.67567567567567566, 0.40540540540540537, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4324324324324324, 0.59459459459459452, 0.83783783783783783, 0.89189189189189189, 0.91891891891891886, 0.94594594594594594, 0.94594594594594594, 0.94594594594594594, 0.81081081081081074, 0.59459459459459452, 0.40540540540540537, 0.16216216216216214, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.72972972972972971, 0.83783783783783783, 0.91891891891891886, 0.94594594594594594, 0.97297297297297292, 0.97297297297297292, 0.97297297297297292, 0.97297297297297292, 0.97297297297297292, 0.89189189189189189, 0.6216216216216216, 0.18918918918918917, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4324324324324324, 0.67567567567567566, 0.83783783783783783, 0.89189189189189189, 0.89189189189189189, 0.89189189189189189, 0.89189189189189189, 0.83783783783783783, 0.56756756756756754, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    u'longwinter': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.058823529411764712, 0.26470588235294118, 0.41176470588235292, 0.5, 0.55882352941176472, 0.61764705882352944, 0.70588235294117652, 0.82352941176470584, 0.94117647058823539, 0.97058823529411786, 0.97058823529411786, 0.97058823529411786, 0.97058823529411786, 1.0, 0.97058823529411786, 0.88235294117647067, 0.79411764705882359, 0.6470588235294118, 0.58823529411764697, 0.4705882352941177, 0.36764705882352949, 0.26470588235294118, 0.11764705882352942, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.088235294117647065, 0.26470588235294118, 0.44117647058823534, 0.52941176470588236, 0.55882352941176472, 0.6029411764705882, 0.6470588235294118, 0.73529411764705899, 0.82352941176470584, 0.85294117647058831, 0.85294117647058831, 0.85294117647058831, 0.85294117647058831, 0.85294117647058831, 0.82352941176470584, 0.82352941176470584, 0.82352941176470584, 0.67647058823529416, 0.61764705882352944, 0.5, 0.3235294117647059, 0.20588235294117646, 0.088235294117647065, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.23529411764705885, 0.44117647058823534, 0.52941176470588236, 0.61764705882352944, 0.67647058823529416, 0.70588235294117652, 0.70588235294117652, 0.70588235294117652, 0.76470588235294124, 0.82352941176470584, 0.97058823529411786, 1.0, 0.85294117647058831, 0.79411764705882359, 0.73529411764705899, 0.64705882352941191, 0.55882352941176472, 0.4705882352941177, 0.35294117647058826, 0.29411764705882348, 0.14705882352941174, 0.088235294117647065, 0.029411764705882353, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.029411764705882356, 0.17647058823529413, 0.3235294117647059, 0.44117647058823534, 0.55882352941176472, 0.61764705882352944, 0.70588235294117652, 0.76470588235294124, 0.79411764705882359, 0.82352941176470584, 0.88235294117647067, 0.94117647058823539, 0.97058823529411786],
    u'winter': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.029411764705882356, 0.35294117647058826, 0.61764705882352944, 0.82352941176470584, 0.85294117647058831, 0.91176470588235303, 0.94117647058823539, 0.79411764705882359, 0.52941176470588236, 0.11764705882352942, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4705882352941177, 0.67647058823529416, 0.85294117647058831, 0.97058823529411786, 1.0, 0.91176470588235303, 0.79411764705882359, 0.5, 0.088235294117647065, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.11764705882352942, 0.38235294117647062, 0.55882352941176472, 0.67647058823529416, 0.79411764705882359, 0.88235294117647067, 0.91176470588235303, 0.94117647058823539, 0.85294117647058831, 0.6470588235294118, 0.44117647058823534, 0.029411764705882356, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.44117647058823534, 0.94117647058823539, 0.97058823529411786, 1.0],
    u'summerwinter': [1.0, 0.97222222222222221, 0.91666666666666674, 0.77777777777777779, 0.52777777777777779, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3611111111111111, 0.66666666666666663, 0.86111111111111116, 0.94444444444444442, 0.94444444444444442, 0.69444444444444453, 0.13888888888888887, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.44444444444444448, 0.88888888888888895, 0.97222222222222221, 0.88888888888888895, 0.61111111111111105, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.30555555555555552, 0.75, 0.91666666666666674, 0.94444444444444442, 0.86111111111111116, 0.75, 0.69444444444444453, 0.3611111111111111, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.083333333333333329, 0.63888888888888895, 0.80555555555555558, 0.91666666666666674, 0.97222222222222221, 0.97222222222222221, 0.94444444444444442, 0.69444444444444453, 0.30555555555555552, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.13888888888888887, 0.83333333333333337, 1.0, 1.0, 1.0, 0.97222222222222221, 0.91666666666666674, 0.77777777777777779, 0.61111111111111105, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.55555555555555547, 0.88888888888888895, 0.94444444444444442, 0.94444444444444442, 0.94444444444444442, 0.83333333333333337, 0.02777777777777778, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.22222222222222224, 0.66666666666666663, 0.83333333333333337, 0.91666666666666674, 0.91666666666666674],
    u'spring': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.5, 0.75, 0.86111111111111116, 0.91666666666666674, 0.86111111111111116, 0.22222222222222224, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.44444444444444448, 0.77777777777777779, 0.86111111111111116, 0.88888888888888895, 0.88888888888888895, 0.88888888888888895, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.75, 0.88888888888888895, 1.0, 0.94444444444444442, 0.76388888888888884, 0.58333333333333337, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    u'longsummer': [1.0, 1.0, 1.0, 0.92105263157894746, 0.86842105263157909, 0.76315789473684215, 0.6842105263157896, 0.57894736842105265, 0.47368421052631582, 0.31578947368421056, 0.18421052631578949, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18421052631578949, 0.31578947368421056, 0.36842105263157898, 0.4210526315789474, 0.47368421052631582, 0.57894736842105265, 0.60526315789473695, 0.65789473684210542, 0.71052631578947378, 0.76315789473684215, 0.78947368421052633, 0.81578947368421062, 0.8421052631578948, 0.86842105263157909, 0.89473684210526316, 0.89473684210526316, 0.86842105263157909, 0.8421052631578948, 0.78947368421052633, 0.73684210526315796, 0.65789473684210542, 0.60526315789473695, 0.5, 0.44736842105263158, 0.39473684210526316, 0.31578947368421056, 0.18421052631578949, 0.052631578947368425, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.10526315789473685, 0.2105263157894737, 0.39473684210526316, 0.52631578947368418, 0.60526315789473695, 0.65789473684210542, 0.71052631578947378, 0.73684210526315796, 0.81578947368421062, 0.86842105263157909, 0.89473684210526316, 0.89473684210526316, 0.86842105263157909, 0.85526315789473695, 0.8421052631578948, 0.81578947368421062, 0.73684210526315796, 0.63157894736842113, 0.47368421052631582, 0.3421052631578948, 0.23684210526315791, 0.026315789473684213, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.026315789473684213, 0.052631578947368425, 0.18421052631578949, 0.3421052631578948, 0.47368421052631582, 0.52631578947368418, 0.57894736842105265, 0.63157894736842113, 0.6842105263157896, 0.73684210526315796, 0.81578947368421062, 0.86842105263157909, 0.89473684210526316, 0.89473684210526316, 0.89473684210526316, 0.89473684210526316, 0.89473684210526316, 0.86842105263157909, 0.8421052631578948, 0.81578947368421062, 0.76315789473684215, 0.71052631578947378, 0.65789473684210542, 0.57894736842105265, 0.5, 0.4210526315789474, 0.31578947368421056, 0.15789473684210528, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    u'vshape': [0.7570093457943925, 0.71962616822429903, 0.68224299065420557, 0.644859813084112, 0.61682242990654212, 0.58878504672897192, 0.57476635514018692, 0.56074766355140182, 0.54672897196261683, 0.53271028037383172, 0.52336448598130836, 0.51401869158878499, 0.49532710280373826, 0.46728971962616828, 0.45794392523364486, 0.44859813084112149, 0.43925233644859807, 0.43925233644859807, 0.42056074766355139, 0.39719626168224292, 0.37383177570093451, 0.35046728971962615, 0.32710280373831774, 0.30841121495327101, 0.28971962616822433, 0.27102803738317754, 0.25233644859813081, 0.24299065420560748, 0.23364485981308414, 0.20560747663551399, 0.2009345794392523, 0.19626168224299065, 0.1822429906542056, 0.16822429906542055, 0.14953271028037382, 0.14018691588785046, 0.13084112149532709, 0.11214953271028037, 0.10747663551401868, 0.10280373831775699, 0.07476635514018691, 0.060747663551401862, 0.046728971962616814, 0.032710280373831772, 0.018691588785046728, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.018691588785046728, 0.028037383177570093, 0.056074766355140186, 0.084112149532710276, 0.10280373831775702, 0.12149532710280374, 0.16822429906542055, 0.19626168224299065, 0.21495327102803738, 0.23364485981308414, 0.27102803738317754, 0.30841121495327106, 0.30841121495327106, 0.32710280373831774, 0.3364485981308411, 0.35046728971962615, 0.3644859813084112, 0.40186915887850466, 0.42990654205607476, 0.43925233644859807, 0.45794392523364486, 0.48598130841121495, 0.51401869158878499, 0.54205607476635509, 0.56074766355140182, 0.59813084112149528, 0.63551401869158874, 0.65420560747663548, 0.65420560747663548, 0.65887850467289721, 0.66355140186915884, 0.67289719626168221, 0.68224299065420557, 0.69158878504672894, 0.7009345794392523, 0.7009345794392523, 0.72429906542056066, 0.7359813084112149, 0.74182242990654201, 0.74474299065420557, 0.7462032710280373, 0.74693341121495327, 0.74766355140186902, 0.7570093457943925, 0.76168224299065401, 0.76635514018691575, 0.79439252336448585, 0.82242990654205594, 0.85981308411214952, 0.89719626168224298, 0.91588785046728971, 0.93457943925233655, 0.94392523364485981, 0.95327102803738317, 0.9719626168224299, 0.98130841121495327, 0.99065420560747652, 1.0, 0.0],
    u'fall': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.069767441860465115, 0.32558139534883718, 0.53488372093023251, 0.67441860465116277, 0.7441860465116279, 0.67441860465116277, 0.46511627906976732, 0.046511627906976744, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18604651162790697, 0.39534883720930231, 0.55813953488372092, 0.69767441860465107, 0.72093023255813959, 0.34883720930232553, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.55813953488372092, 0.7441860465116279, 0.81395348837209303, 0.83720930232558133, 0.79069767441860461, 0.41860465116279066, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.95348837209302317, 0.81395348837209303, 0.53488372093023251, 0.11627906976744183, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    u'downward': [0.0, 1.0, 0.95041322314049603, 0.94214876033057859, 0.94214876033057859, 0.93388429752066127, 0.93388429752066127, 0.93388429752066127, 0.9173553719008265, 0.90082644628099173, 0.8925619834710744, 0.88016528925619841, 0.86776859504132231, 0.86363636363636376, 0.85950413223140509, 0.85123966942148777, 0.84297520661157033, 0.834710743801653, 0.82644628099173567, 0.8099173553719009, 0.80165289256198347, 0.79338842975206614, 0.77685950413223137, 0.77272727272727271, 0.76859504132231404, 0.74380165289256206, 0.72727272727272729, 0.71487603305785141, 0.70247933884297531, 0.69421487603305787, 0.68595041322314054, 0.66942148760330578, 0.65289256198347101, 0.64462809917355379, 0.62809917355371903, 0.62396694214876036, 0.6198347107438017, 0.59917355371900838, 0.57851239669421495, 0.56611570247933884, 0.55371900826446285, 0.54545454545454553, 0.53719008264462809, 0.5123966942148761, 0.50826446280991733, 0.50413223140495866, 0.49586776859504134, 0.48760330578512395, 0.48760330578512395, 0.47933884297520657, 0.4710743801652893, 0.45454545454545453, 0.43801652892561982, 0.43801652892561982, 0.42975206611570255, 0.42561983471074388, 0.42148760330578516, 0.4173553719008265, 0.41322314049586784, 0.40082644628099179, 0.38842975206611569, 0.3801652892561983, 0.37190082644628103, 0.36363636363636365, 0.35950413223140498, 0.35537190082644632, 0.33884297520661155, 0.33057851239669417, 0.3223140495867769, 0.31818181818181818, 0.31404958677685951, 0.30578512396694213, 0.2975206611570248, 0.28925619834710747, 0.28512396694214875, 0.28099173553719009, 0.27685950413223143, 0.27272727272727276, 0.26446280991735538, 0.26033057851239672, 0.25619834710743805, 0.23966942148760334, 0.23553719008264465, 0.23140495867768596, 0.21487603305785127, 0.21487603305785127, 0.21487603305785127, 0.20661157024793392, 0.19008264462809921, 0.18181818181818182, 0.17355371900826447, 0.16528925619834708, 0.15702479338842976, 0.15289256198347106, 0.1487603305785124, 0.14462809917355371, 0.14049586776859505, 0.14049586776859505, 0.13636363636363638, 0.13223140495867769, 0.12396694214876033, 0.11570247933884298, 0.10743801652892564, 0.099173553719008267, 0.090909090909090912, 0.082644628099173542, 0.0743801652892562, 0.061983471074380167, 0.049586776859504134, 0.033057851239669422, 0.033057851239669422, 0.028925619834710748, 0.024793388429752067, 0.016528925619834711, 0.0, 0.0, 0.0, 0.0082644628099173556, 0.0082644628099173556, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    u'nshape': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0043103448275862077, 0.034482758620689655, 0.060344827586206892, 0.073275862068965497, 0.086206896551724116, 0.10344827586206896, 0.12068965517241378, 0.14224137931034483, 0.16379310344827583, 0.18965517241379312, 0.20258620689655174, 0.21551724137931036, 0.23275862068965517, 0.25431034482758624, 0.26508620689655171, 0.27586206896551724, 0.30172413793103448, 0.32758620689655166, 0.33620689655172414, 0.36206896551724138, 0.375, 0.38793103448275862, 0.39655172413793105, 0.4181034482758621, 0.43965517241379309, 0.47413793103448271, 0.49137931034482757, 0.52155172413793105, 0.55172413793103448, 0.58620689655172409, 0.61206896551724133, 0.63793103448275867, 0.66379310344827591, 0.69827586206896552, 0.71120689655172409, 0.72413793103448276, 0.75, 0.77586206896551724, 0.7931034482758621, 0.83620689655172409, 0.87931034482758619, 0.92241379310344829, 0.94827586206896541, 0.98275862068965514, 1.0, 0.97844827586206906, 0.9568965517241379, 0.93103448275862066, 0.9137931034482758, 0.88793103448275856, 0.86206896551724144, 0.83620689655172409, 0.81034482758620685, 0.7931034482758621, 0.78017241379310343, 0.76724137931034486, 0.74137931034482762, 0.72413793103448276, 0.7068965517241379, 0.68965517241379293, 0.65517241379310331, 0.61206896551724133, 0.56896551724137934, 0.53448275862068972, 0.5, 0.47413793103448271, 0.4568965517241379, 0.43965517241379309, 0.42241379310344829, 0.40517241379310348, 0.38793103448275862, 0.36206896551724138, 0.35344827586206895, 0.34051724137931028, 0.32758620689655166, 0.31896551724137934, 0.30172413793103448, 0.2931034482758621, 0.28448275862068967, 0.27155172413793099, 0.25862068965517238, 0.24568965517241378, 0.23275862068965517, 0.21551724137931036, 0.20689655172413793, 0.19827586206896552, 0.18103448275862069, 0.16379310344827583, 0.15086206896551721, 0.13793103448275862, 0.12931034482758619, 0.11637931034482758, 0.10344827586206896, 0.086206896551724144, 0.068965517241379309, 0.034482758620689655, 0.012931034482758621, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    u'upward': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0084745762711864406, 0.012711864406779662, 0.016949152542372881, 0.025423728813559324, 0.025423728813559324, 0.033898305084745763, 0.042372881355932202, 0.046610169491525424, 0.050847457627118647, 0.059322033898305086, 0.063559322033898302, 0.067796610169491525, 0.076271186440677971, 0.084745762711864403, 0.093220338983050849, 0.093220338983050849, 0.093220338983050849, 0.10169491525423729, 0.11864406779661017, 0.13559322033898305, 0.13983050847457629, 0.1440677966101695, 0.16949152542372881, 0.17796610169491525, 0.1864406779661017, 0.20338983050847459, 0.21186440677966106, 0.22033898305084748, 0.23728813559322035, 0.25423728813559321, 0.27966101694915257, 0.29661016949152547, 0.30508474576271188, 0.31355932203389836, 0.33050847457627119, 0.3347457627118644, 0.33898305084745761, 0.34745762711864409, 0.35169491525423724, 0.3559322033898305, 0.3728813559322034, 0.38135593220338987, 0.38983050847457629, 0.40254237288135597, 0.41525423728813565, 0.42372881355932213, 0.42796610169491528, 0.43220338983050849, 0.44067796610169491, 0.44915254237288138, 0.4576271186440678, 0.47033898305084748, 0.48305084745762716, 0.48305084745762716, 0.49152542372881353, 0.5, 0.50423728813559321, 0.50847457627118642, 0.51694915254237284, 0.52542372881355937, 0.53389830508474578, 0.5381355932203391, 0.5423728813559322, 0.55932203389830515, 0.56355932203389836, 0.56779661016949157, 0.57627118644067798, 0.5847457627118644, 0.59322033898305093, 0.59745762711864414, 0.60169491525423724, 0.61016949152542377, 0.61864406779661019, 0.62711864406779672, 0.64406779661016944, 0.66101694915254239, 0.66101694915254239, 0.66949152542372881, 0.67796610169491522, 0.68644067796610175, 0.69067796610169485, 0.69491525423728817, 0.71186440677966101, 0.72881355932203395, 0.73728813559322037, 0.74576271186440679, 0.74576271186440679, 0.75423728813559332, 0.76271186440677974, 0.76271186440677974, 0.77118644067796605, 0.77118644067796605, 0.77118644067796605, 0.78813559322033899, 0.82203389830508478, 0.84745762711864425, 0.85593220338983056, 0.86440677966101698, 0.88135593220338992, 0.89830508474576276, 0.90677966101694929, 0.9152542372881356, 0.93220338983050843, 0.94915254237288138, 1.0]
}

# small number used to avoid dividing by zero
REALLY_SMALL_NUMBER = 0.0000000000001

############################# Initialization ##################################
# max count of values in column for it to be categorical
MAX_CATEGORICAL_VALUES = 20

# where cache of db meta stored
DB_META_PICKLE_PATH = '/z/dol/emeril/_pickle/db_meta'

# scraper cache dir (building field importance)
SCRAPER_CACHE_FILE = '/z/dol/emeril/_pickle/scraper/scraper.cache'


################# Find distrib changes / interesting flds #####################
# corrs below this not considered changed by lt/gte median filter
DISTRIB_CHANGE_MIN_CORR = 0.5

# where cache of changed analysis stored
CHANGED_PICKLE_PATH = '/z/dol/emeril/_pickle/changed'


############################### Candidate Gen #################################
# in-out-ratio cache
IN_OUT_RATIO_PICKLE_PATH = '/z/dol/emeril/_pickle/in_out_ratio'

# pred candidates cache
CANDIDATE_PREDS_PICKLE_PATH = '/z/dol/emeril/_pickle/candidate_preds'

# The minimum percentage of total sub-bin histogram in order to be a candidate
# (for candidate gen with 'use_min_density' mode)
MIN_DENSITY = 0.10

# the number of preds to grab from each sub-bin
# (for candidate gen in 'use_sub_bin_count' mode)
TOP_SUB_BIN_COUNT = 4


########################## Synthetic Data Generation ##########################
# dir for pickle files with synthetic data/preds/etc.
DATA_GEN_CACHE_DIR = "/z/dol/emeril/cache/syn_data"

# directory for stats/results of syn-data runs
DATA_GEN_EXP_META_DIR = "/z/dol/emeril/cache/experiment_meta"


################################ MIP solving ##################################
PRED_PAIR_META_CACHE_DIR = "/z/dol/emeril/cache/pred_pair_meta"

MIP_INPUT_FILE_DIR = "/z/dol/emeril/cache/mip_input_files"

########################## Query building/evaluating ##########################

# the number of preds to grab from each bin in algos before doing n-choose-k
NUM_PREDS_PER_BIN = 5

# 'k' when doing n-choose-k in algo3/etc.
MAX_PREDS = 3

# the beta scores used in sig vs. code query scoring (greater than 1.0 prefers code)
QUERY_SCORE_BETAS = ('allsig', 0.25, 1.0, 2.0, 'allcode')




from .utils import *
from .algos import *
from .baselines import *
from .candidate_gen import *
from .evaluation import *
from .find_interesting_fields import *
from .identify_issues import *
from .initialization import *
